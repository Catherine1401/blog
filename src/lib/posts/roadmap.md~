๐งฉ Bฦฐแปc 1 โ Hแปc cรกch giao tiแบฟp vแปi CNOSDB
โ Mแปฅc tiรชu:
Biแบฟt cรกch giao tiแบฟp, ghi vร ฤแปc dแปฏ liแปu tแปซ CNOSDB.

๐๏ธ Viแปc cแบงn lรm:
Tรฌm hiแปu CNOSDB lร gรฌ, cรกch hoแบกt ฤแปng (time-series database).

Cรi ฤแบทt CNOSDB local (qua Docker hoแบทc bแบฃn cรi sแบตn).

Tรฌm hiแปu Line Protocol hoแบทc JSON format cแปงa CNOSDB.

Test ghi dแปฏ liแปu mแบซu bแบฑng curl hoแบทc Postman:

bash
Copy
Edit
curl -X POST http://localhost:port/write \
     --data-raw "weather,location=greenhouse temperature=31.2,humidity=65"
Hแปc truy vแบฅn dแปฏ liแปu vแปi curl hoแบทc Web UI (nแบฟu cรณ).

๐ Kแบฟt quแบฃ:
Ghi vร ฤแปc ฤฦฐแปฃc dแปฏ liแปu mแบซu thแปง cรดng tแปซ terminal/Postman.

๐งฉ Bฦฐแปc 2 โ Viแบฟt script Python sinh dแปฏ liแปu giแบฃ
โ Mแปฅc tiรชu:
Tแบกo dแปฏ liแปu cแบฃm biแบฟn nhฦฐ thแบญt ฤแป mรด phแปng mรดi trฦฐแปng nรดng nghiแปp.

๐๏ธ Viแปc cแบงn lรm:
Tแบกo file Python sensor_simulator.py.

Sinh cรกc giรก trแป ngแบซu nhiรชn:

Nhiแปt ฤแป: random.uniform(25, 40)

ฤแป แบฉm ฤแบฅt: random.randint(10, 90)

รnh sรกng: random.randint(300, 1200)

Gแบฏn timestamp hiแปn tแบกi, format lแบกi ฤรบng chuแบฉn line protocol:

python
Copy
Edit
f"sensor_data temperature={temp},humidity={humid},light={light} {timestamp}"
In ra terminal ฤแป kiแปm tra dแปฏ liแปu sinh.

๐ Kแบฟt quแบฃ:
File Python sinh dแปฏ liแปu cแบฃm biแบฟn ฤแปu ฤแบทn, ฤรบng ฤแปnh dแบกng chuแบฉn.

๐งฉ Bฦฐแปc 3 โ Ghi dแปฏ liแปu vรo CNOSDB
โ Mแปฅc tiรชu:
Gแปญi dแปฏ liแปu cแบฃm biแบฟn tแปซ Python vรo CNOSDB.

๐๏ธ Viแปc cแบงn lรm:
Dรนng thฦฐ viแปn requests gแปญi POST:

python
Copy
Edit
requests.post("http://localhost:port/write", data=data_line)
Viแบฟt vรฒng lแบทp while True gแปญi mแปi 5s.

Kiแปm tra trong CNOSDB xem dแปฏ liแปu cรณ ghi thรnh cรดng khรดng.

๐ Kแบฟt quแบฃ:
Dแปฏ liแปu cแบฃm biแบฟn ฤฦฐแปฃc ghi ฤแปu ฤแบทn vรo CNOSDB qua Python.

๐งฉ Bฦฐแปc 4 โ Truy vแบฅn dแปฏ liแปu tแปซ CNOSDB
โ Mแปฅc tiรชu:
ฤแปc vร xแปญ lรฝ dแปฏ liแปu ฤแป phรขn tรญch.

๐๏ธ Viแปc cแบงn lรm:
Dรนng Python gแปญi truy vแบฅn HTTP GET hoแบทc dรนng API nแบฟu CNOSDB cรณ hแป trแปฃ.

Viแบฟt truy vแบฅn nhฦฐ:

"SELECT last(temperature) FROM sensor_data"

"SELECT mean(humidity) WHERE time > now() - 1h"

Parse kแบฟt quแบฃ JSON trแบฃ vแป.

๐ Kแบฟt quแบฃ:
Truy xuแบฅt dแปฏ liแปu cแบฃm biแบฟn trong khoแบฃng thแปi gian thแปฑc tแบฟ, cรณ thแป dรนng ฤฦฐแปฃc.

๐งฉ Bฦฐแปc 5 โ Dแปฑng giao diแปn ฤฦกn giแบฃn
โ Mแปฅc tiรชu:
Tแบกo giao diแปn thรขn thiแปn hiแปn thแป trแบกng thรกi vร dแปฏ liแปu.

๐๏ธ Viแปc cแบงn lรm:
Dรนng Streamlit (giao diแปn web ฤฦกn giแบฃn vแปi Python).

Hiแปn thแป:

Biแปu ฤแป nhiแปt ฤแป, ฤแป แบฉm, รกnh sรกng (dรนng altair, matplotlib, plotly).

Trแบกng thรกi hiแปn tแบกi (dแปฑa trรชn logic แป bฦฐแปc sau).

Cแบญp nhแบญt theo thแปi gian thแปฑc.

๐ Kแบฟt quแบฃ:
Giao diแปn ฤฦกn giแบฃn, cแบญp nhแบญt dแปฏ liแปu theo thแปi gian thแปฑc.

๐งฉ Bฦฐแปc 6 โ Thiแบฟt lแบญp trแบกng thรกi thรดng minh
โ Mแปฅc tiรชu:
Thiแบฟt lแบญp cรกc rule mรด phแปng tแปฑ ฤแปng hรณa nhฦฐ con ngฦฐแปi.

๐๏ธ Viแปc cแบงn lรm:
Viแบฟt cรกc ฤiแปu kiแปn (rule):

Nhiแปt ฤแป > 35ยฐC vร รกnh sรกng > 900 lux โ โNแบฏng nรณngโ

ฤแป แบฉm ฤแบฅt < 30% โ โKhรด hแบกn โ cแบงn tฦฐแปiโ

Dรนng if-else trong Python ฤแป phรขn tรญch.

In trแบกng thรกi ra hoแบทc ฤแปi mรu trรชn Streamlit.

๐ Kแบฟt quแบฃ:
Hแป thแปng tแปฑ xรกc ฤแปnh trแบกng thรกi mรดi trฦฐแปng vร ฤฦฐa ra phแบฃn แปฉng.

๐งฉ Bฦฐแปc 7 โ Thiแบฟt lแบญp hแป thแปng phรขn tรกn vร cรขn bแบฑng tแบฃi
โ Mแปฅc tiรชu:
Tฤng tรญnh sแบตn sรng vร แปn ฤแปnh cแปงa hแป thแปng.

๐๏ธ Viแปc cแบงn lรm:
Phรขn tรกn CNOSDB:

Cรi ฤแบทt nhiแปu instance CNOSDB (trรชn Docker hoแบทc nhiแปu mรกy).

Thiแบฟt lแบญp replication giแปฏa cรกc node.

Cแบฅu hรฌnh retention policy vร shard group (nแบฟu CNOSDB hแป trแปฃ).

Load balancing:

Dรนng NGINX hoแบทc viแบฟt Python chแปn node random:

python
Copy
Edit
url = random.choice(["http://node1", "http://node2"])
Log lแบกi node ฤang gแปญi dแปฏ liแปu ฤแป kiแปm chแปฉng phรขn tรกn.

๐ Kแบฟt quแบฃ:
Hแป thแปng vแบซn ghi/ฤแปc dแปฏ liแปu bรฌnh thฦฐแปng khi 1 node chแบฟt. Truy cแบญp ฤฦฐแปฃc nhiแปu node, ฤแบฃm bแบฃo cรขn bแบฑng tแบฃi.


